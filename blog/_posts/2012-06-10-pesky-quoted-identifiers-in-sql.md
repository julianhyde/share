---
layout: post
title: Pesky quoted identifiers in SQL
date: '2012-06-10T14:35:00.000-07:00'
author: Julian Hyde
tags: 
modified_time: '2012-06-10T14:35:02.339-07:00'
blogger_id: tag:blogger.com,1999:blog-5672165237896126100.post-1814599178937302582
blogger_orig_url: https://julianhyde.blogspot.com/2012/06/pesky-quoted-identifiers-in-sql.html
---

<p>The SQL that Mondrian generates is, until now, different than the SQL that most people would write by hand. Most people don't use spaces or punctuation in table and column names, and don't enclose identifiers in quotation marks when writing SQL DDL, DML or queries. Mondrian, on the other hand, religiously quotes every identifier, whether it needs it or not.</p> <p>The two styles are not compatible because on many databases (Oracle is one example) unquoted identifiers are implicitly converted to upper-case. If you use lower-case table and column names in Mondrian's schema, they will not match the upper-case identifiers created during DDL.</p> <p>For instance, if you create a table in Oracle using</p> <blockquote><code>CREATE TABLE emp (<br/>&nbsp;&nbsp;empno INTEGER,<br/>&nbsp;&nbsp;ename VARCHAR2(30),<br/>&nbsp;&nbsp;deptno INTEGER);</code></blockquote> <p>then Oracle creates a table called EMP with columns EMPNO, ENAME and DEPTNO. When you query it using</p> <blockquote><code>SELECT ename FROM emp WHERE deptno = 20;</code></blockquote> <p>the effect is as if you had written</p> <blockquote><code>SELECT ENAME FROM EMP WHERE DEPTNO = 20;</code></blockquote> <p>Now, if you'd told Mondrian that the table was called "emp", Mondrian tries to be helpful. It generates the query</p> <blockquote><code>SELECT "ename" FROM "emp" WHERE "deptno" = 20;</code></blockquote> <p>Of course, there is no table called "emp", only one called "EMP", so on case-sensitive databases such as Oracle this causes an error. You then need to go back to your schema and change</p> <blockquote><code>&lt;Table name="emp"/&gt;</code></blockquote> to  <blockquote><code>&lt;Table name="EMP"/&gt;</code></blockquote> <p>and all other table and column names in your schema. Yuck!</p> <p>There is now a simpler way. The Schema XML element has a <code>quoteSql</code> attribute:</p> <blockquote><code>&lt;Schema name='FoodMart' metamodelVersion='4.0' quoteSql='false'&gt;</code></blockquote> <p>If you set <code>quoteSql='false'</code>, Mondrian will not quote identifiers when generating SQL. (Actually, it will still quote them if they contain spaces and such. But we recommend that if you use <code>quoteSql='false'</code>, you use sensible table names containing only alphanumeric characters and '_'.)</p> <p>More details can be found in <a href="http://jira.pentaho.com/browse/MONDRIAN-887">MONDRIAN-887</a>. It is only fixed in the lagunitas branch (i.e., mondrian-4.0 alpha), and only in new-style schemas (not mondrian-3 style schemas automatically upgraded). Give it a try and let me know how it works for you.</p>